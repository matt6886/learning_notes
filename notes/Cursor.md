# Cursor

## 原型界面到小程序界面

### 原型界面的生成

**Prompt**

> 我想开发一个小程序
>
> 目标用户：
>
> - 主要用户：25-45岁的家长，没时间来教小孩怎么写作文，也可能不知道还在对应年级作文的写作规范和要求
> - 用户痛点：1、家长难以针对孩子写作弱点提供定制化提升方案
>
> ​        2、无法获得实时写作建议
>
> 我目前想到的核心功能如下：
>
> 1、用户可以对作文进行拍照，然后上传图片
>
> 2、调用大模型对作文进行批改
>
> 3、每次批改作文消耗一个积分，使用微信支付进行充值可获得积分
>
> 4、用户使用微信授权登陆，登陆完成需要绑定手机号
>
> 现在需要你帮我输出高保真的原型图，请通过以下方式帮我完成所有界面的原型设计，并确保这些原型界面可以直接用于开发：
>
> 1、用户体验分析：先分析这个小程序的主要功能和用户需求，确定核心交互逻辑。
>
> 2、产品界面规划：作为产品经理，定义关键界面，确保信息架构合理。
>
> 3、高保真 UI 设计：作为 UI 设计师，设计贴近真实小程序设计规范的界面，使用现代化的 UI 元素，使其具有良好的视觉体验。
>
> 4、HTML 原型实现：使用 HTML + Tailwind CSS（或 Bootstrap）生成所有原型界面，并使用 FontAwesome（或其他开源 UI 组件）让界面更加精美、接近真实的 小程序 设计。拆分代码文件，保持结构清晰：
>
> 5、每个界面应作为独立的 HTML 文件存放，例如 home.html、profile.html、settings.html 等。
>
> - index.html 作为主入口，不直接写入所有界面的 HTML 代码，而是使用 iframe 的方式嵌入这些 HTML 片段，并将所有页面直接平铺展示在 index 页面中，而不是跳转链接。
> - 真实感增强：  - 界面尺寸应模拟 iPhone 15 Pro，并让界面圆角化，使其更像真实的手机界面。 
> - 使用真实的 UI 图片，而非占位符图片（可从 Unsplash、Pexels、Apple 官方 UI 资源中选择）。 
> - 添加顶部状态栏（模拟 iOS 状态栏），并包含 App 导航栏（类似 iOS 底部 Tab Bar）。
>
> 请按照以上要求生成完整的 HTML 代码，并确保其可用于实际开发。

****



### 导出原型图

使用谷歌 Fireshot 插件,导出PNG图



### 新建项目

使用对应的框架工具新建项目，如expo脚手架新建项目，新建项目的目的是保证文件架构的准确性。



### 初始化rules

目的是保证项目能遵循统一的规范。

匹配 /components/\*\*/\*，/pages/\*\*/\*

> 你是一个经验丰富的小程序开发人员，擅长解决各种小程序开发问题，严格遵守小程序开发规范
>
> ### 项目结构
>
> - components
>
>   /**这里存放小程序的自定义组件，每个组件单独一个文件夹 */
>
> - pages
>
>  /**这里存放小程序的页面，每个页面单独一个文件夹 */
>
> - api
>
> /** 这里存放调用后端服务的文件，按模块划分，每个模块一个文件,文件命名：**Api.js */
>
> - static
>
> /**存放其他常用js或者静态资源图片 */
>
> ### ui及页面规范
>
> - 所有页面必须包含 js、json、wxml、wxss文件，json文件必须包含以下基本内容
>
> {
>
>   "navigationBarTitleText": "上传作文",
>
>   "usingComponents": {
>
>   }
>
> }
>
>  
>
> ### 代码规范：
>
> ​    \- 使用微信小程序原生框架进行开发，合理使用组件化开发。
>
> ​    \- 遵循微信小程序设计规范，确保良好的用户体验。
>
> ​    \- 利用微信小程序提供的API进行功能开发，如登录、支付、地理位置等。
>
> ​    \- 使用分包加载优化小程序体积和加载性能。
>
> ​    \- 合理使用页面生命周期函数和组件生命周期函数。
>
> ​    \- 编写详细的代码注释，并在代码中添加必要的错误处理和日志记录。
>
> ​    \- 合理使用本地存储和缓存机制。



跟后端交互的rules文件

**匹配 api/*.js**

> ** 入参要求
>
>    \- header中必须设置 auth， 值为当前登录后保存的token值
>
>    \- 请求的参数使用json 格式， 就算是参数为空，也需要使用 {} 来代替
>
> ** http请求
>
>    请求方式默认是post，除非有明确要求
>
> ** 返参
>
>   \- 后端统一返回的参数为json对象，格式如下
>
>    {
>
> ​    "error": 0,
>
> ​     "body": object,
>
> ​     "message": ''
>
>    }
>
>  error =0, 表示没有任何异常
>
>  error = 500, 表示系统异常，需要弹出系统异常的错误
>
>  error = 401，表示需要登录
>
>  error 其它值，表示业务异常，直接弹出 message内容
>
>  body 是一个对象
>
>  ** 设计一个通用函数来处理后端API返回值，所有的API文件都是用这个通用函数



### 微调界面

fireshot导出来的界面可能不完整，需要手动截取图片发到cursor中再进行调整。



### 常见问题及解决方案

1）小程序的顶部导航和底部tab

用rules提前来规范，我就是刚开始没有，导致导航一直不对

2）使用第三方框架一直有问题

给出示例代码，让cursor明白正确的是什么

3）出现卡顿

使用 @pastchats 来新开对话窗口

4）生成的小程序页面结构不全

在rules中已经设定了规则



## 前后端对接拆解

### API接口对接

**传统模式**

先后端出接口定义，前端人员按照接口定义自己搭建模拟数据，这样的好处是

前端，后端都能同时开发，互不影响

**Cursor模式**

![whiteboard_exported_image](/Users/matt/Desktop/Learning/learning_notes/notes/images/cursor_api.png)



### 生成API接口文档

1. **最好的方式，在rules中定义接口变化同时更新接口文档**

> ** 入参要求
>
> - header中必须设置 auth， 值为当前登录后保存的token值
> - 请求的参数使用json 格式， 就算是参数为空，也需要使用 {} 来代替
>
> ** http请求
>
>    请求方式默认是post，除非有明确要求
>
> ** 返参
>
> - 后端统一返回的参数为json对象，格式如下
>
> {
>
> "error": 0,
>
>  "body": object,
>
>  "message": ''
>
>    }
>
>  error =0, 表示没有任何异常
>
>  error = 500, 表示系统异常，需要弹出系统异常的错误
>
>  error = 401，表示需要登录
>
>  error 其它值，表示业务异常，直接弹出 message内容
>
>  body 是一个对象
>
>  ** 设计一个通用函数来处理后端API返回值，所有的API文件都是用这个通用函数
>
>  ** 当接口发生修改或者新增时，将接口信息按照如下格式：
>
>  接口名称
>
> - 接口核心功能描述，不超过200字
> - 接口地址: /print/assembly/{id}/export-pdf
> - 方法: GET
> - 需要登录: 是
> - 请求参数: 无
> - 响应类型: blob
> - 返回值：{}
>
> 同步更新到  @接口文档.md



2. **也可以全局扫描的方式生成接口文档**

> 我现在需要一份接口文档，你需要扫描每个页面,页面在 @pages @components   ，按照以下流程来获取页面中的接口信息
>
> - 从页面中获取调用的接口，并找到接口调用的真实地址,如果没有你可以自己生成真实的接口地址
> - 从页面中获取调用接口的入参和返参，并放到下面的格式中返回
> - 出参和入参的格式定义需要符合接口的统一规则 api.mdc
> - 接口需要标出是否需要登陆才能访问
>
> 最后生成md文档保存起来
>
> 格式如下：
>
> 接口名称
>
> - 接口核心功能描述，不超过200字
> - 接口地址: /print/assembly/{id}/export-pdf
> - 方法: GET
> - 需要登录: 是
> - 请求参数: 无
> - 响应类型: blob
> - 返回值：{}
>
> 记得把 接口规则文档放到上下文中



### 需求文档

需求文档的目的是 让后端明白系统是干什么用的，不用拘泥于需求文档是什么格式。

你可以自己写，或者让AI生成。

> 根据  核心功能和
>
> - 核心功能1
> - 核心功能2
> - 核心功能3
>
> 参考  @API_DOCUMENTATION_NEW.md 接口定义，总结一个标准的需求文档给我



### 生成好端项目

1. **先建空的文件夹，配置好rules**

rules使用GitHub开源的

https://github.com/sanjeed5/awesome-cursor-rules-mdc/tree/main/rules-mdc

2. **将接口文档和需求文档拷贝到空文件中**

去掉需求文档中非功能描述的其他内容。

使用thinking 模式

> 请仔细阅读 @接口文档.md , @需求文档.md ， 遵守 @flask.mdc 规则，完成项目的初始化。请注意以下事项:
>
> - @接口文档.md 里面定义的所有接口必须全部实现，接口名称和出入参格式保持一致
> - 数据库使用mysql

3. **生成建表语句**

按照rules生成的项目会有初始化数据库的方法

或者用以下提示词生成建表语句

> @models 根据文件生成对应的mysql 建表语句



## 如何让AI写好后端代码

### 可能碰到问题

- 你试图修复一个小错误
- 人工智能给出一个看似合理的更改建议
- 这个修复导致其他地方出错
- 你要求人工智能修复新出现的问题
- 这又产生了另外两个问题
- 如此反复



### 老生常谈rules

- 通用性rules
- 框架型rules
- 个性化rules

> /Generate Cursor Rules 我现在需要生成一个rules，目的是 @api 里面的每个route发生变化时必须执行自动化测试，并将测试结果告诉我

Generate Cursor Rules 的出现，让rules的创建更偏向从问题出发，更容易创建属于自己的rules

开源常用的rules

https://github.com/sanjeed5/awesome-cursor-rules-mdc



### 做好自动化测试很重要

- 项目初始化完成后的第一次测试
- 平时变更完成后的测试



### 少说车轱辘话，多说流程的话

![cursor_workflow](/Users/matt/Desktop/Learning/learning_notes/notes/images/cursor_workflow.png)



### 用好mermaid流程画图工具

用好mermaid流程画图工具

https://www.mermaidchart.com/play#pako:eNp10E1Pg0AQBuC_MpmTPXCA9sSh0WI9GZu09eR6mMAgJHS2welHQvjvTtlWjFFu7PvMux8d5r5gTLFs_CmvqFV4XjsB-x7eHG7UVhy-QxTBxu8YlM9qP3NY3DnMvGgtB3Y4CSOLIco6h8sjNQdSi_oQZZeKlfAgHq16tdfaC8TW_kNsT34Qy1Ekv0TVcmh5MlNSWlKUUwtXPf3WElu-5lxJPhq-XuKzqodZSSx8teNrwwW82BuMc0kQ0_9FHMTsT3Ez953tRntOobVD9LfycbmoaddfvBPsvwACjHSl



## 前后端连调技巧

### 开发环境，线上环境

开发环境(本地环境）: 后端服务在本地启动，数据库在本地，只能自己访问

线上环境（正式环境）： 后端服务在服务器启动，数据在服务器，所有人能访问

所以，联调的前提必须有环境的配置，这也是一个正常前后端项目应该具备的

- 前端项目的环境配置，最主要是 需要对接的API服务地址
- 后端项目的环境配置，最主要是 数据库链接地址，或者其他一些重要的配置

如果现有的项目没有环境配置，你可以添加以下对话提示词，让cursor给你生成：

> 帮我生成项目的环境配置文件，环境包括开发环境和线上环境，需要支持我很方便的进行环境切换。

有环境配置的项目，最好是在通用的rules或者自定义rules中加上如下一条内容，防止cursor误改了环境配置的内容

> \## 禁止随意修改环境配置
>
> 1. **严禁**未经授权修改环境配置，包括但不限于：
>
>    \- 修改环境的配置
>
>    \- 修改环境的配置
>
>    \- 添加或删除环境变量
>
> 2. **严禁**在未经测试的情况下修改环境配置
> 3. **严禁**在未经项目负责人批准的情况下向生产环境提交环境配置的更改

或者自己手动生成rules

> /Generate Cursor Rules 这个项目是微信小程序项目，帮我生成一个通用的项目规则，需要包含环境的配置，支持快速切换不同的环境，并且要求环境的配置没有经过我的允许不能修改



### 两种连调模式

1. **一键联调**

将前端后端项目放到一个文件夹内，在cursor中可以共享上下文

![cursor_liantiao1](/Users/matt/Desktop/Learning/learning_notes/notes/images/cursor_liantiao1.png)

优点：

- 方便快速，能一次对话完成前后端同时修改

缺点：

- 上下文长度容易超出，经常要new Chat
- rules比较多，管理容易混乱
- 你需要经常在对话中指定 项目所在的目录，比如 改小程序，你需要@ 小程序目录，这样才能限定cursor检索代码的范围

2. **跨项目联调**

优点：

- 职责单一，管理清晰，上下文的内容比较明确，因为你只针对 前端的逻辑或者后端的逻辑
- rules管理起来比较方便

缺点：

- 需要维护API文档（其实这是一个好习惯）
- 需要打开两个cursor
- 如果前后端改的是同一个东西，同样的逻辑你需要在前端的cursor对话框和后端的cursor对话框中说两次

### 跨项目联调API文档处理方法

![cursor_liantiao2](/Users/matt/Desktop/Learning/learning_notes/notes/images/cursor_liantiao2.png)

用API文档的变化来驱动前后端项目的变化

- 从前端同步到后端： 界面先行，更容易理解，有视觉上的变化差异
- 从后端同步到前端：接口先行，适合前后端分开处理，能清楚知道逻辑

你的对话内容->拆解后端API及逻辑,生成一个让后端服务能懂的业务清单->让后端服务生成实现的代码

> /Generate Cursor Rules  我的项目是一个前后端分离的项目，现在这个项目是前端项目，我希望前端项目在发生变更时，如果涉及到后端的接口变化，你帮我生成一个后端服务的任务清单，我将任务任务清单发给后端服务能直接生成代码。
>
> 任务清单放到doc中。
>
> 基于以上需求，帮我生成一个rules

> # API接口变更追踪规则
>
> ## 目的
>
> 该规则用于监控前端项目中涉及后端接口的变更，并自动生成后端服务的任务清单，便于直接发送给后端团队进行实现。
>
> ## 规则指引
>
> ### 接口文档
>
> 前端项目中的接口文档位于 @doc/api.md，所有接口变更应该同步更新到此文档。
>
> ### 后端任务清单
>
> 当前端需求变更涉及到后端接口时，应生成后端任务清单，并存放在 @doc/backend-tasks.md 文件中。
>
> ### 任务清单格式规范
>
> 任务清单应包含以下内容：
>
> 1. 变更概述 - 简要描述此次需求中涉及的接口变更
> 2. 详细任务列表 - 每个接口变更的详细信息
>    1. 接口名称与路径
>    2. 变更类型（新增/修改/删除）
>    3. 请求参数变更
>    4. 返回值变更
>    5. 业务逻辑说明
>    6. 预计工作量
> 3. 依赖关系 - 接口之间的依赖关系
> 4. 测试用例 - 关键测试场景描述
>
> ## 工作流程
>
> 1. 前端开发确认需求变更涉及后端接口
> 2. 更新接口文档，明确接口规范
> 3. 生成后端任务清单
> 4. 提交给后端团队，进行开发实现
> 5. 完成后进行联调测试
>
> ## 示例任务清单
>
> # 后端任务清单 - 用户登录模块优化
>
> ## 变更概述
>
> 优化用户登录流程，增加第三方登录支持，调整密码规则
>
> ## 详细任务列表
>
> ### 1. 新增第三方登录接口
>
> - 接口路径: /user/thirdPartyLogin
> - 变更类型: 新增
> - 请求参数:
>
> ​    "platform": "string", *// 平台类型: 'wechat', 'qq', 'weibo'*
>
> ​    "code": "string",
>
> ​    "userInfo": {
>
> ​      *// 用户信息对象*
>
> ​    }
>
>   }
>
> ​        *// 用户信息对象*
>
> ​      },
>
> ​      "isNewUser": true *// 是否新用户*
>
> ​    },
>
> ​    "message": ""
>
>   }



## Cursor 基本操作



### Tab补全

**自动补全**

根据上下文自动补全

**智能改写**

根据上下文改写代码

**光标预测**

智能跳过没有问题的代码，跳转到有问题的代码

可以在cursor编辑器右下方的状态栏关闭tab补全功能

**部分补全**



### Chat对话框

commond + I：新建一个chat对话框

commond + L：关闭chat对话框



### 内嵌对话框

commond + k : 在当前窗口生成内嵌对话框，针对鼠标下方的内容，如果选中文本，在点击编辑，则是针对选中的内容

内嵌对话框问答模式



### Codebase



@提示符

* @files/folders
* @docs

在设置里面添加文档连接，然后在chat聊天框中添加到上下文

@git

@web



### AddModel

增加三方语言模型



### 实战演习

1. 设计网站功能和页面图纸 

* 网站功能规划（需求描述）

新建一个网站规划的，利用tab的自动补全功能，描述网站的核心功能

* 网站UI设计图

根据网站规划文件，生成UI设计图，无法生成图片，但是可以生成线框图组成的示意图

* 项目代码架构设计文档

根据上一步生成的设计图，生成网站代码架构设计文档

> 1. 根据功能判断是否需要使用后端服务
> 2. 只设计文档中存在的功能，不用增加其他功能
> 3. 文档内容应当简单易懂，无需进行复杂设计
> 4. 目录的结构也要写到这个文件中

2. 安装开发环境并生成首页

* 生成首页

根据之前生成的首页网站功能规划文件，UI示意图，目录结构，项目代码架构设计文档，UI设计截图，生成代码



**开发流程**

* 需求分析
* UI示意图
* 项目架构设计
* 数据库设计
* 实际功能开发

































